var c=Object.defineProperty;var r=(e,t,i)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var s=(e,t,i)=>(r(e,typeof t!="symbol"?t+"":t,i),i);import{r as n,a as p,j as o}from"./index.1da63547.js";import{B as w}from"./button.52476b55.js";import"./index.a2923c53.js";import"./isVisible.7ca29fb7.js";import"./render.43ae6a3d.js";import"./AntdIcon.78424b7e.js";import"./Compact.9bf7b630.js";class f{constructor(t,i){s(this,"width",70);s(this,"height",20);s(this,"alive",!0);s(this,"lifes",2);this.x=t,this.y=i}kill(){this.lifes--,this.lifes<1&&(this.alive=!1)}collide(t){const i=this,h=[i.x+i.width/2,i.y+i.height/2],a=[t.x+t.width/2,t.y+t.height/2],l=Math.abs(h[0]-a[0]),d=Math.abs(h[1]-a[1]);return l<=(i.width+t.width)/2&&d<=(i.height+t.height)/2}}class u{constructor(t){s(this,"x",100);s(this,"y",350);s(this,"width",300);s(this,"height",30);s(this,"speed",10);s(this,"canvasWidth");this.canvasWidth=t}moveLeft(){let t=this.x-this.speed;t<0&&(t=0),this.x=t}moveRight(){let t=this.x+this.speed;t>this.canvasWidth-this.width&&(t=this.canvasWidth-this.width),this.x=t}collide(t){const i=this,h=[i.x+i.width/2,i.y+i.height/2],a=[t.x+t.width/2,t.y+t.height/2],l=Math.abs(h[0]-a[0]),d=Math.abs(h[1]-a[1]);return l<=(i.width+t.width)/2&&d<=(i.height+t.height)/2}}class v{constructor(t,i){s(this,"x",100);s(this,"y",250);s(this,"width",50);s(this,"height",50);s(this,"speedX",3);s(this,"speedY",3);s(this,"fired",!1);s(this,"lastBump",!1);s(this,"canvasWidth");s(this,"canvasHeight");this.canvasWidth=t,this.canvasHeight=i}move(){!this.fired||((this.x<0||this.x+this.width>600)&&this.reboundX(),(this.y<0||this.y+this.height>400)&&this.reboundY(),this.x+=this.speedX,this.y+=this.speedY)}suspend(){this.fired=!this.fired}reboundY(){this.speedY*=-1}reboundX(){this.speedX*=-1}}class y{constructor(t){s(this,"width",600);s(this,"height",400);s(this,"canvas");s(this,"ctx");s(this,"keydowns",{});s(this,"actions",{});s(this,"blocks",[]);s(this,"status","start");s(this,"ball");s(this,"paddle");s(this,"levels",[[[50,50],[150,120]],[[50,0],[100,100],[150,130]],[[50,30],[100,100],[200,100]]]);s(this,"onKeyDown",t=>{this.keydowns[t.key]=!0,t.key==="s"&&this.ball.suspend();const i=parseInt(t.key);isNaN(i)||this.switchLevel(i)});s(this,"switchLevel",t=>{var i;t-=1,this.blocks=[],(i=this.levels[t])==null||i.forEach(h=>{const a=new f(h[0],h[1]);this.blocks.push(a)})});s(this,"onKeyUp",t=>{this.keydowns[t.key]=!1});s(this,"frameLoop",()=>{for(let t in this.keydowns)this.keydowns[t]&&this.actions[t]&&this.actions[t]();this.update(),this.clearCanvas(),this.drawCanvas(),this.status!=="end"&&requestAnimationFrame(this.frameLoop)});this.ball=new v(this.width,this.height),this.paddle=new u(this.width),this.canvas=document.createElement("canvas"),t.appendChild(this.canvas),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.border="1px solid",this.ctx=this.canvas.getContext("2d"),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),this.registerAction("a",()=>{this.paddle.moveLeft()}),this.registerAction("d",()=>{this.paddle.moveRight()}),this.frameLoop()}close(){this.status="end",window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)}registerAction(t,i){this.actions[t]=i}update(){this.ball.move(),this.paddle.collide(this.ball)?(this.ball.lastBump||this.ball.reboundY(),this.ball.lastBump=!0):this.ball.lastBump=!1,this.blocks.forEach(t=>{t.collide(this.ball)&&(this.ball.reboundY(),t.kill())}),this.blocks=this.blocks.filter(t=>t.alive)}drawCanvas(){this.drawPaddle(),this.drawBall(),this.drawBlock()}drawBlock(){this.blocks.forEach(t=>{this.ctx.fillStyle="black",this.ctx.fillRect(t.x,t.y,t.width,t.height)})}drawPaddle(){this.ctx.fillStyle="black",this.ctx.fillRect(this.paddle.x,this.paddle.y,this.paddle.width,this.paddle.height)}drawBall(){this.ctx.fillStyle="red",this.ctx.fillRect(this.ball.x,this.ball.y,this.ball.width,this.ball.height)}clearCanvas(){this.ctx.clearRect(0,0,this.width,this.height)}}class R extends n.exports.PureComponent{constructor(){super(...arguments);s(this,"divRef",n.exports.createRef());s(this,"game",null);s(this,"onCloseClick",()=>{var i;(i=this.game)==null||i.close()})}componentDidMount(){const i=this.divRef.current;this.game=new y(i)}componentWillUnmount(){var i;(i=this.game)==null||i.close()}render(){return p("div",{style:{padding:"30px"},children:[o("div",{ref:this.divRef}),o(w,{onClick:this.onCloseClick,children:"CLOSE"})]})}}export{R as default};
