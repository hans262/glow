import{j as s,r as m,a as U}from"./index.1da63547.js";import{a as Et,i as Dt,m as At,t as Bt,n as We,s as Rt,c as Ce,b as Ue,f as Mt,d as Ge,e as Ot,g as _t}from"./index.5de002d9.js";import{u as Ft}from"./useSetState.12359b3d.js";import{u as Tt}from"./useMount.d3fcb0a7.js";import{S as qe}from"./index.6cff07d6.js";import{g as kt,B as me}from"./button.52476b55.js";import{p as Pt,D as zt}from"./DownOutlined.9ddc88b9.js";import{A as jt}from"./AntdIcon.78424b7e.js";import{_ as Lt,a as Ht,b as Ae,c as Be,g as rt,m as Vt,r as ve,C as at,d as G,e as Wt,f as M,h as ue,w as Ut,i as Ke,j as Gt,k as qt,l as Kt,n as Xt,F as Yt,u as Zt,D as Jt,N as Xe,o as Qt}from"./index.a2923c53.js";import{K as ge}from"./KeyCode.b4f9faf0.js";import{u as en,a as $e}from"./useMergedState.31cb9ce1.js";import{i as tn}from"./index.73d170ae.js";import{r as nn,c as Ye}from"./isVisible.7ca29fb7.js";import{i as rn,g as it,a as ot,b as st,c as an,d as on,e as sn,f as ln,h as cn,j as Ee}from"./index.434e4ebc.js";import{u as un,N as Ze}from"./Compact.9bf7b630.js";import{C as dn}from"./CheckCircleFilled.3f6be613.js";import{C as fn}from"./CloseCircleFilled.ad36d395.js";import{C as pn}from"./CloseOutlined.2f07144d.js";import{I as mn,E as gn,m as Z}from"./index.6265da24.js";import{P as hn}from"./progress.9bbbf2eb.js";import"./useFlexGapSupport.aeea6946.js";import"./render.43ae6a3d.js";import"./CheckOutlined.334c284f.js";import"./index.5d21e9af.js";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Je(t,e,n){if(Et(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Dt(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return At(t,e,r,n)}const be=28,Se=28,ae=be*Se,Qe=65e3,vn="/glow/mnist_images.png",de=10,bn="/glow/mnist_labels_uint8",lt=5e4;function Sn(){return new Promise(t=>{const e=new Image,n=document.createElement("canvas"),r=n.getContext("2d");e.src=vn,e.onload=()=>{e.width=e.naturalWidth,e.height=e.naturalHeight;const a=new ArrayBuffer(Qe*ae),o=5e3;n.width=e.width,n.height=o;for(let p=0;p<Qe/o;p++){r.drawImage(e,0,p*o,e.width,o,0,0,e.width,o);const h=r.getImageData(0,0,n.width,n.height),u=new Uint8Array(a,p*e.width*o,e.width*o);for(let b=0;b<u.length;b++)u[b]=h.data[b*4]}const d=new Uint8Array(a);console.log(d);const c=d.slice(0,ae*lt);t(c)}})}function yn(){return new Promise(async t=>{const e=await fetch(bn).then(a=>a.arrayBuffer()),r=new Uint8Array(e).slice(0,de*lt);t(r)})}let xn=function(t){Lt(n,t);var e=Ht(n);function n(){var r;return Ae(this,n),r=e.apply(this,arguments),r.state={error:void 0,info:{componentStack:""}},r}return Be(n,[{key:"componentDidCatch",value:function(a,o){this.setState({error:a,info:o})}},{key:"render",value:function(){const{message:a,description:o,children:d}=this.props,{error:c,info:p}=this.state,h=p&&p.componentStack?p.componentStack:null,u=typeof a>"u"?(c||"").toString():a,b=typeof o>"u"?h:o;return c?s(ut,{type:"error",message:u,description:s("pre",{style:{fontSize:"0.9em",overflowX:"auto"},children:b})}):d}}]),n}(m.exports.Component);const Nn=xn,he=(t,e,n,r,a)=>({backgroundColor:t,border:`${r.lineWidth}px ${r.lineType} ${e}`,[`${a}-icon`]:{color:n}}),wn=t=>{const{componentCls:e,motionDurationSlow:n,marginXS:r,marginSM:a,fontSize:o,fontSizeLG:d,lineHeight:c,borderRadiusLG:p,motionEaseInOutCirc:h,alertIconSizeLG:u,colorText:b,paddingContentVerticalSM:i,alertPaddingHorizontal:g,paddingMD:x,paddingContentHorizontalLG:N,colorTextHeading:E}=t;return{[e]:Object.assign(Object.assign({},ve(t)),{position:"relative",display:"flex",alignItems:"center",padding:`${i}px ${g}px`,wordWrap:"break-word",borderRadius:p,[`&${e}-rtl`]:{direction:"rtl"},[`${e}-content`]:{flex:1,minWidth:0},[`${e}-icon`]:{marginInlineEnd:r,lineHeight:0},["&-description"]:{display:"none",fontSize:o,lineHeight:c},"&-message":{color:b},[`&${e}-motion-leave`]:{overflow:"hidden",opacity:1,transition:`max-height ${n} ${h}, opacity ${n} ${h},
        padding-top ${n} ${h}, padding-bottom ${n} ${h},
        margin-bottom ${n} ${h}`},[`&${e}-motion-leave-active`]:{maxHeight:0,marginBottom:"0 !important",paddingTop:0,paddingBottom:0,opacity:0}}),[`${e}-with-description`]:{alignItems:"flex-start",paddingInline:N,paddingBlock:x,[`${e}-icon`]:{marginInlineEnd:a,fontSize:u,lineHeight:0},[`${e}-message`]:{display:"block",marginBottom:r,color:E,fontSize:d},[`${e}-description`]:{display:"block"}},[`${e}-banner`]:{marginBottom:0,border:"0 !important",borderRadius:0}}},In=t=>{const{componentCls:e,colorSuccess:n,colorSuccessBorder:r,colorSuccessBg:a,colorWarning:o,colorWarningBorder:d,colorWarningBg:c,colorError:p,colorErrorBorder:h,colorErrorBg:u,colorInfo:b,colorInfoBorder:i,colorInfoBg:g}=t;return{[e]:{"&-success":he(a,r,n,t,e),"&-info":he(g,i,b,t,e),"&-warning":he(c,d,o,t,e),"&-error":Object.assign(Object.assign({},he(u,h,p,t,e)),{[`${e}-description > pre`]:{margin:0,padding:0}})}}},Cn=t=>{const{componentCls:e,iconCls:n,motionDurationMid:r,marginXS:a,fontSizeIcon:o,colorIcon:d,colorIconHover:c}=t;return{[e]:{["&-action"]:{marginInlineStart:a},[`${e}-close-icon`]:{marginInlineStart:a,padding:0,overflow:"hidden",fontSize:o,lineHeight:`${o}px`,backgroundColor:"transparent",border:"none",outline:"none",cursor:"pointer",[`${n}-close`]:{color:d,transition:`color ${r}`,"&:hover":{color:c}}},"&-close-text":{color:d,transition:`color ${r}`,"&:hover":{color:c}}}}},$n=t=>[wn(t),In(t),Cn(t)],En=rt("Alert",t=>{const{fontSizeHeading3:e}=t,n=Vt(t,{alertIconSizeLG:e,alertPaddingHorizontal:12});return[$n(n)]});var Dn=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const An={success:dn,info:mn,error:fn,warning:gn},Bn=t=>{const{icon:e,prefixCls:n,type:r}=t,a=An[r]||null;return e?nn(e,s("span",{className:`${n}-icon`,children:e}),()=>({className:G(`${n}-icon`,{[e.props.className]:e.props.className})})):m.exports.createElement(a,{className:`${n}-icon`})},Rn=t=>{const{isClosable:e,closeText:n,prefixCls:r,closeIcon:a,handleClose:o}=t;return e?s("button",{type:"button",onClick:o,className:`${r}-close-icon`,tabIndex:0,children:n?s("span",{className:`${r}-close-text`,children:n}):a}):null},ct=t=>{var{description:e,prefixCls:n,message:r,banner:a,className:o,rootClassName:d,style:c,onMouseEnter:p,onMouseLeave:h,onClick:u,afterClose:b,showIcon:i,closable:g,closeText:x,closeIcon:N=s(pn,{}),action:E}=t,C=Dn(t,["description","prefixCls","message","banner","className","rootClassName","style","onMouseEnter","onMouseLeave","onClick","afterClose","showIcon","closable","closeText","closeIcon","action"]);const[$,R]=m.exports.useState(!1),l=m.exports.useRef(null),{getPrefixCls:D,direction:A}=m.exports.useContext(at),w=D("alert",n),[_,F]=En(w),T=B=>{var j;R(!0),(j=C.onClose)===null||j===void 0||j.call(C,B)},q=()=>{const{type:B}=C;return B!==void 0?B:a?"warning":"info"},O=x?!0:g,k=q(),z=a&&i===void 0?!0:i,X=G(w,`${w}-${k}`,{[`${w}-with-description`]:!!e,[`${w}-no-icon`]:!z,[`${w}-banner`]:!!a,[`${w}-rtl`]:A==="rtl"},o,d,F),J=Pt(C,{aria:!0,data:!0});return _(s(Wt,{visible:!$,motionName:`${w}-motion`,motionAppear:!1,motionEnter:!1,onLeaveStart:B=>({maxHeight:B.offsetHeight}),onLeaveEnd:b,children:B=>{let{className:j,style:K}=B;return U("div",{...Object.assign({ref:l,"data-show":!$,className:G(X,j),style:Object.assign(Object.assign({},c),K),onMouseEnter:p,onMouseLeave:h,onClick:u,role:"alert"},J),children:[z?s(Bn,{description:e,icon:C.icon,prefixCls:w,type:k}):null,U("div",{className:`${w}-content`,children:[r?s("div",{className:`${w}-message`,children:r}):null,e?s("div",{className:`${w}-description`,children:e}):null]}),E?s("div",{className:`${w}-action`,children:E}):null,s(Rn,{isClosable:!!O,closeText:x,prefixCls:w,closeIcon:N,handleClose:T})]})}}))};ct.ErrorBoundary=Nn;const ut=ct;var Mn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"}}]},name:"up",theme:"outlined"};const On=Mn;var _n=function(e,n){return s(jt,{...e,ref:n,icon:On})};const Fn=m.exports.forwardRef(_n);function De(){return typeof BigInt=="function"}function te(t){var e=t.trim(),n=e.startsWith("-");n&&(e=e.slice(1)),e=e.replace(/(\.\d*[^0])0*$/,"$1").replace(/\.0*$/,"").replace(/^0+/,""),e.startsWith(".")&&(e="0".concat(e));var r=e||"0",a=r.split("."),o=a[0]||"0",d=a[1]||"0";o==="0"&&d==="0"&&(n=!1);var c=n?"-":"";return{negative:n,negativeStr:c,trimStr:r,integerStr:o,decimalStr:d,fullStr:"".concat(c).concat(r)}}function Re(t){var e=String(t);return!Number.isNaN(Number(e))&&e.includes("e")}function fe(t){var e=String(t);if(Re(t)){var n=Number(e.slice(e.indexOf("e-")+2)),r=e.match(/\.(\d+)/);return r!=null&&r[1]&&(n+=r[1].length),n}return e.includes(".")&&Me(e)?e.length-e.indexOf(".")-1:0}function xe(t){var e=String(t);if(Re(t)){if(t>Number.MAX_SAFE_INTEGER)return String(De()?BigInt(t).toString():Number.MAX_SAFE_INTEGER);if(t<Number.MIN_SAFE_INTEGER)return String(De()?BigInt(t).toString():Number.MIN_SAFE_INTEGER);e=t.toFixed(fe(e))}return te(e).fullStr}function Me(t){return typeof t=="number"?!Number.isNaN(t):t?/^\s*-?\d+(\.\d+)?\s*$/.test(t)||/^\s*-?\d+\.\s*$/.test(t)||/^\s*-?\.\d+\s*$/.test(t):!1}function dt(t){return!t&&t!==0&&!Number.isNaN(t)||!String(t).trim()}var Tn=function(){function t(e){if(Ae(this,t),M(this,"origin",""),M(this,"number",void 0),M(this,"empty",void 0),dt(e)){this.empty=!0;return}this.origin=String(e),this.number=Number(e)}return Be(t,[{key:"negate",value:function(){return new t(-this.toNumber())}},{key:"add",value:function(n){if(this.isInvalidate())return new t(n);var r=Number(n);if(Number.isNaN(r))return this;var a=this.number+r;if(a>Number.MAX_SAFE_INTEGER)return new t(Number.MAX_SAFE_INTEGER);if(a<Number.MIN_SAFE_INTEGER)return new t(Number.MIN_SAFE_INTEGER);var o=Math.max(fe(this.number),fe(r));return new t(a.toFixed(o))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return Number.isNaN(this.number)}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(n){return this.toNumber()===(n==null?void 0:n.toNumber())}},{key:"lessEquals",value:function(n){return this.add(n.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.number}},{key:"toString",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return n?this.isInvalidate()?"":xe(this.number):this.origin}}]),t}(),kn=function(){function t(e){if(Ae(this,t),M(this,"origin",""),M(this,"negative",void 0),M(this,"integer",void 0),M(this,"decimal",void 0),M(this,"decimalLen",void 0),M(this,"empty",void 0),M(this,"nan",void 0),dt(e)){this.empty=!0;return}if(this.origin=String(e),e==="-"||Number.isNaN(e)){this.nan=!0;return}var n=e;if(Re(n)&&(n=Number(n)),n=typeof n=="string"?n:xe(n),Me(n)){var r=te(n);this.negative=r.negative;var a=r.trimStr.split(".");this.integer=BigInt(a[0]);var o=a[1]||"0";this.decimal=BigInt(o),this.decimalLen=o.length}else this.nan=!0}return Be(t,[{key:"getMark",value:function(){return this.negative?"-":""}},{key:"getIntegerStr",value:function(){return this.integer.toString()}},{key:"getDecimalStr",value:function(){return this.decimal.toString().padStart(this.decimalLen,"0")}},{key:"alignDecimal",value:function(n){var r="".concat(this.getMark()).concat(this.getIntegerStr()).concat(this.getDecimalStr().padEnd(n,"0"));return BigInt(r)}},{key:"negate",value:function(){var n=new t(this.toString());return n.negative=!n.negative,n}},{key:"add",value:function(n){if(this.isInvalidate())return new t(n);var r=new t(n);if(r.isInvalidate())return this;var a=Math.max(this.getDecimalStr().length,r.getDecimalStr().length),o=this.alignDecimal(a),d=r.alignDecimal(a),c=(o+d).toString(),p=te(c),h=p.negativeStr,u=p.trimStr,b="".concat(h).concat(u.padStart(a+1,"0"));return new t("".concat(b.slice(0,-a),".").concat(b.slice(-a)))}},{key:"isEmpty",value:function(){return this.empty}},{key:"isNaN",value:function(){return this.nan}},{key:"isInvalidate",value:function(){return this.isEmpty()||this.isNaN()}},{key:"equals",value:function(n){return this.toString()===(n==null?void 0:n.toString())}},{key:"lessEquals",value:function(n){return this.add(n.negate().toString()).toNumber()<=0}},{key:"toNumber",value:function(){return this.isNaN()?NaN:Number(this.toString())}},{key:"toString",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return n?this.isInvalidate()?"":te("".concat(this.getMark()).concat(this.getIntegerStr(),".").concat(this.getDecimalStr())).fullStr:this.origin}}]),t}();function L(t){return De()?new kn(t):new Tn(t)}function ye(t,e,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(t==="")return"";var a=te(t),o=a.negativeStr,d=a.integerStr,c=a.decimalStr,p="".concat(e).concat(c),h="".concat(o).concat(d);if(n>=0){var u=Number(c[n]);if(u>=5&&!r){var b=L(t).add("".concat(o,"0.").concat("0".repeat(n)).concat(10-u));return ye(b.toString(),e,n,r)}return n===0?h:"".concat(h).concat(e).concat(c.padEnd(n,"0").slice(0,n))}return p===".0"?h:"".concat(h).concat(p)}var Pn=function(){var e=m.exports.useState(!1),n=ue(e,2),r=n[0],a=n[1];return en(function(){a(tn())},[]),r},zn=200,jn=600;function Ln(t){var e=t.prefixCls,n=t.upNode,r=t.downNode,a=t.upDisabled,o=t.downDisabled,d=t.onStep,c=m.exports.useRef(),p=m.exports.useRef();p.current=d;var h=function(C,$){C.preventDefault(),p.current($);function R(){p.current($),c.current=setTimeout(R,zn)}c.current=setTimeout(R,jn)},u=function(){clearTimeout(c.current)};m.exports.useEffect(function(){return u},[]);var b=Pn();if(b)return null;var i="".concat(e,"-handler"),g=G(i,"".concat(i,"-up"),M({},"".concat(i,"-up-disabled"),a)),x=G(i,"".concat(i,"-down"),M({},"".concat(i,"-down-disabled"),o)),N={unselectable:"on",role:"button",onMouseUp:u,onMouseLeave:u};return U("div",{className:"".concat(i,"-wrap"),children:[s("span",{...N,onMouseDown:function(C){h(C,!0)},"aria-label":"Increase Value","aria-disabled":a,className:g,children:n||s("span",{unselectable:"on",className:"".concat(e,"-handler-up-inner")})}),s("span",{...N,onMouseDown:function(C){h(C,!1)},"aria-label":"Decrease Value","aria-disabled":o,className:x,children:r||s("span",{unselectable:"on",className:"".concat(e,"-handler-down-inner")})})]})}function et(t){var e=typeof t=="number"?xe(t):te(t).fullStr,n=e.includes(".");return n?te(e.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:t+"0"}function Hn(t,e){var n=m.exports.useRef(null);function r(){try{var o=t.selectionStart,d=t.selectionEnd,c=t.value,p=c.substring(0,o),h=c.substring(d);n.current={start:o,end:d,value:c,beforeTxt:p,afterTxt:h}}catch{}}function a(){if(t&&n.current&&e)try{var o=t.value,d=n.current,c=d.beforeTxt,p=d.afterTxt,h=d.start,u=o.length;if(o.endsWith(p))u=o.length-n.current.afterTxt.length;else if(o.startsWith(c))u=c.length;else{var b=c[h-1],i=o.indexOf(b,h-1);i!==-1&&(u=i+1)}t.setSelectionRange(u,u)}catch(g){Ut(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(g.message))}}return[r,a]}const Vn=function(){var t=m.exports.useRef(0),e=function(){Ke.cancel(t.current)};return m.exports.useEffect(function(){return e},[]),function(n){e(),t.current=Ke(function(){n()})}};var Wn=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","controls","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep"],tt=function(e,n){return e||n.isEmpty()?n.toString():n.toNumber()},nt=function(e){var n=L(e);return n.isInvalidate()?null:n},ft=m.exports.forwardRef(function(t,e){var n,r=t.prefixCls,a=r===void 0?"rc-input-number":r,o=t.className,d=t.style,c=t.min,p=t.max,h=t.step,u=h===void 0?1:h,b=t.defaultValue,i=t.value,g=t.disabled,x=t.readOnly,N=t.upHandler,E=t.downHandler,C=t.keyboard,$=t.controls,R=$===void 0?!0:$,l=t.stringMode,D=t.parser,A=t.formatter,w=t.precision,_=t.decimalSeparator,F=t.onChange,T=t.onInput,q=t.onPressEnter,O=t.onStep,k=Gt(t,Wn),z="".concat(a,"-input"),X=m.exports.useRef(null),J=m.exports.useState(!1),B=ue(J,2),j=B[0],K=B[1],H=m.exports.useRef(!1),Y=m.exports.useRef(!1),Q=m.exports.useRef(!1),ee=m.exports.useState(function(){return L(i!=null?i:b)}),V=ue(ee,2),S=V[0],P=V[1];function pe(v){i===void 0&&P(v)}var ie=m.exports.useCallback(function(v,f){if(!f)return w>=0?w:Math.max(fe(v),fe(u))},[w,u]),oe=m.exports.useCallback(function(v){var f=String(v);if(D)return D(f);var I=f;return _&&(I=I.replace(_,".")),I.replace(/[^\w.-]+/g,"")},[D,_]),Oe=m.exports.useRef(""),_e=m.exports.useCallback(function(v,f){if(A)return A(v,{userTyping:f,input:String(Oe.current)});var I=typeof v=="number"?xe(v):v;if(!f){var y=ie(I,f);if(Me(I)&&(_||y>=0)){var W=_||".";I=ye(I,W,y)}}return I},[A,ie,_]),gt=m.exports.useState(function(){var v=b!=null?b:i;return S.isInvalidate()&&["string","number"].includes(qt(v))?Number.isNaN(v)?"":v:_e(S.toString(),!1)}),Fe=ue(gt,2),se=Fe[0],Te=Fe[1];Oe.current=se;function le(v,f){Te(_e(v.isInvalidate()?v.toString(!1):v.toString(!f),f))}var ne=m.exports.useMemo(function(){return nt(p)},[p,w]),re=m.exports.useMemo(function(){return nt(c)},[c,w]),ke=m.exports.useMemo(function(){return!ne||!S||S.isInvalidate()?!1:ne.lessEquals(S)},[ne,S]),Pe=m.exports.useMemo(function(){return!re||!S||S.isInvalidate()?!1:S.lessEquals(re)},[re,S]),ht=Hn(X.current,j),ze=ue(ht,2),vt=ze[0],bt=ze[1],je=function(f){return ne&&!f.lessEquals(ne)?ne:re&&!re.lessEquals(f)?re:null},Ne=function(f){return!je(f)},we=function(f,I){var y=f,W=Ne(y)||y.isEmpty();if(!y.isEmpty()&&!I&&(y=je(y)||y,W=!0),!x&&!g&&W){var ce=y.toString(),Ie=ie(ce,I);return Ie>=0&&(y=L(ye(ce,".",Ie)),Ne(y)||(y=L(ye(ce,".",Ie,!0)))),y.equals(S)||(pe(y),F==null||F(y.isEmpty()?null:tt(l,y)),i===void 0&&le(y,I)),y}return S},St=Vn(),Le=function v(f){if(vt(),Te(f),!Y.current){var I=oe(f),y=L(I);y.isNaN()||we(y,!0)}T==null||T(f),St(function(){var W=f;D||(W=f.replace(/。/g,".")),W!==f&&v(W)})},yt=function(){Y.current=!0},xt=function(){Y.current=!1,Le(X.current.value)},Nt=function(f){Le(f.target.value)},He=function(f){var I;if(!(f&&ke||!f&&Pe)){H.current=!1;var y=L(Q.current?et(u):u);f||(y=y.negate());var W=(S||L(0)).add(y.toString()),ce=we(W,!1);O==null||O(tt(l,ce),{offset:Q.current?et(u):u,type:f?"up":"down"}),(I=X.current)===null||I===void 0||I.focus()}},Ve=function(f){var I=L(oe(se)),y=I;I.isNaN()?y=S:y=we(I,f),i!==void 0?le(S,!1):y.isNaN()||le(y,!1)},wt=function(){H.current=!0},It=function(f){var I=f.which,y=f.shiftKey;H.current=!0,y?Q.current=!0:Q.current=!1,I===ge.ENTER&&(Y.current||(H.current=!1),Ve(!1),q==null||q(f)),C!==!1&&!Y.current&&[ge.UP,ge.DOWN].includes(I)&&(He(ge.UP===I),f.preventDefault())},Ct=function(){H.current=!1,Q.current=!1},$t=function(){Ve(!1),K(!1),H.current=!1};return $e(function(){S.isInvalidate()||le(S,!1)},[w]),$e(function(){var v=L(i);P(v);var f=L(oe(se));(!v.equals(f)||!H.current||A)&&le(v,H.current)},[i]),$e(function(){A&&bt()},[se]),U("div",{className:G(a,o,(n={},M(n,"".concat(a,"-focused"),j),M(n,"".concat(a,"-disabled"),g),M(n,"".concat(a,"-readonly"),x),M(n,"".concat(a,"-not-a-number"),S.isNaN()),M(n,"".concat(a,"-out-of-range"),!S.isInvalidate()&&!Ne(S)),n)),style:d,onFocus:function(){K(!0)},onBlur:$t,onKeyDown:It,onKeyUp:Ct,onCompositionStart:yt,onCompositionEnd:xt,onBeforeInput:wt,children:[R&&s(Ln,{prefixCls:a,upNode:N,downNode:E,upDisabled:ke,downDisabled:Pe,onStep:He}),s("div",{className:"".concat(z,"-wrap"),children:s("input",{autoComplete:"off",role:"spinbutton","aria-valuemin":c,"aria-valuemax":p,"aria-valuenow":S.isInvalidate()?null:S.toString(),step:u,...k,ref:Kt(X,e),className:z,value:se,onChange:Nt,disabled:g,readOnly:x})})]})});ft.displayName="InputNumber";const Un=t=>{const{componentCls:e,lineWidth:n,lineType:r,colorBorder:a,borderRadius:o,fontSizeLG:d,controlHeightLG:c,controlHeightSM:p,colorError:h,inputPaddingHorizontalSM:u,colorTextDescription:b,motionDurationMid:i,colorPrimary:g,controlHeight:x,inputPaddingHorizontal:N,colorBgContainer:E,colorTextDisabled:C,borderRadiusSM:$,borderRadiusLG:R,controlWidth:l,handleVisible:D}=t;return[{[e]:Object.assign(Object.assign(Object.assign(Object.assign({},ve(t)),it(t)),ot(t,e)),{display:"inline-block",width:l,margin:0,padding:0,border:`${n}px ${r} ${a}`,borderRadius:o,"&-rtl":{direction:"rtl",[`${e}-input`]:{direction:"rtl"}},"&-lg":{padding:0,fontSize:d,borderRadius:R,[`input${e}-input`]:{height:c-2*n}},"&-sm":{padding:0,borderRadius:$,[`input${e}-input`]:{height:p-2*n,padding:`0 ${u}px`}},"&:hover":Object.assign({},st(t)),"&-focused":Object.assign({},an(t)),"&-disabled":Object.assign(Object.assign({},on(t)),{[`${e}-input`]:{cursor:"not-allowed"}}),"&-out-of-range":{[`${e}-input-wrap`]:{input:{color:h}}},"&-group":Object.assign(Object.assign(Object.assign({},ve(t)),sn(t)),{"&-wrapper":{display:"inline-block",textAlign:"start",verticalAlign:"top",[`${e}-affix-wrapper`]:{width:"100%"},"&-lg":{[`${e}-group-addon`]:{borderRadius:R}},"&-sm":{[`${e}-group-addon`]:{borderRadius:$}}}}),[e]:{"&-input":Object.assign(Object.assign(Object.assign(Object.assign({},ve(t)),{width:"100%",height:x-2*n,padding:`0 ${N}px`,textAlign:"start",backgroundColor:"transparent",border:0,borderRadius:o,outline:0,transition:`all ${i} linear`,appearance:"textfield",fontSize:"inherit"}),ln(t.colorTextPlaceholder)),{'&[type="number"]::-webkit-inner-spin-button, &[type="number"]::-webkit-outer-spin-button':{margin:0,webkitAppearance:"none",appearance:"none"}})}})},{[e]:{[`&:hover ${e}-handler-wrap, &-focused ${e}-handler-wrap`]:{opacity:1},[`${e}-handler-wrap`]:{position:"absolute",insetBlockStart:0,insetInlineEnd:0,width:t.handleWidth,height:"100%",background:E,borderStartStartRadius:0,borderStartEndRadius:o,borderEndEndRadius:o,borderEndStartRadius:0,opacity:D===!0?1:0,display:"flex",flexDirection:"column",alignItems:"stretch",transition:`opacity ${i} linear ${i}`,[`${e}-handler`]:{display:"flex",alignItems:"center",justifyContent:"center",flex:"auto",height:"40%",[`
              ${e}-handler-up-inner,
              ${e}-handler-down-inner
            `]:{marginInlineEnd:0,fontSize:t.handleFontSize}}},[`${e}-handler`]:{height:"50%",overflow:"hidden",color:b,fontWeight:"bold",lineHeight:0,textAlign:"center",cursor:"pointer",borderInlineStart:`${n}px ${r} ${a}`,transition:`all ${i} linear`,"&:active":{background:t.colorFillAlter},"&:hover":{height:"60%",[`
              ${e}-handler-up-inner,
              ${e}-handler-down-inner
            `]:{color:g}},"&-up-inner, &-down-inner":Object.assign(Object.assign({},Xt()),{color:b,transition:`all ${i} linear`,userSelect:"none"})},[`${e}-handler-up`]:{borderStartEndRadius:o},[`${e}-handler-down`]:{borderBlockStart:`${n}px ${r} ${a}`,borderEndEndRadius:o},"&-disabled, &-readonly":{[`${e}-handler-wrap`]:{display:"none"},[`${e}-input`]:{color:"inherit"}},[`
          ${e}-handler-up-disabled,
          ${e}-handler-down-disabled
        `]:{cursor:"not-allowed"},[`
          ${e}-handler-up-disabled:hover &-handler-up-inner,
          ${e}-handler-down-disabled:hover &-handler-down-inner
        `]:{color:C}}},{[`${e}-borderless`]:{borderColor:"transparent",boxShadow:"none",[`${e}-handler-down`]:{borderBlockStartWidth:0}}}]},Gn=t=>{const{componentCls:e,inputPaddingHorizontal:n,inputAffixPadding:r,controlWidth:a,borderRadiusLG:o,borderRadiusSM:d}=t;return{[`${e}-affix-wrapper`]:Object.assign(Object.assign(Object.assign({},it(t)),ot(t,`${e}-affix-wrapper`)),{position:"relative",display:"inline-flex",width:a,padding:0,paddingInlineStart:n,"&-lg":{borderRadius:o},"&-sm":{borderRadius:d},[`&:not(${e}-affix-wrapper-disabled):hover`]:Object.assign(Object.assign({},st(t)),{zIndex:1}),"&-focused, &:focus":{zIndex:1},"&-disabled":{[`${e}[disabled]`]:{background:"transparent"}},[`> div${e}`]:{width:"100%",border:"none",outline:"none",[`&${e}-focused`]:{boxShadow:"none !important"}},[`input${e}-input`]:{padding:0},"&::before":{width:0,visibility:"hidden",content:'"\\a0"'},[`${e}-handler-wrap`]:{zIndex:2},[e]:{"&-prefix, &-suffix":{display:"flex",flex:"none",alignItems:"center",pointerEvents:"none"},"&-prefix":{marginInlineEnd:r},"&-suffix":{position:"absolute",insetBlockStart:0,insetInlineEnd:0,zIndex:1,height:"100%",marginInlineEnd:n,marginInlineStart:r}}})}},qn=rt("InputNumber",t=>{const e=rn(t);return[Un(e),Gn(e),kt(e)]},t=>({controlWidth:90,handleWidth:t.controlHeightSM-t.lineWidth*2,handleFontSize:t.fontSize/2,handleVisible:"auto"}));var Kn=globalThis&&globalThis.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const pt=m.exports.forwardRef((t,e)=>{const{getPrefixCls:n,direction:r}=m.exports.useContext(at),[a,o]=m.exports.useState(!1),d=m.exports.useRef(null);m.exports.useImperativeHandle(e,()=>d.current);const{className:c,rootClassName:p,size:h,disabled:u,prefixCls:b,addonBefore:i,addonAfter:g,prefix:x,bordered:N=!0,readOnly:E,status:C,controls:$}=t,R=Kn(t,["className","rootClassName","size","disabled","prefixCls","addonBefore","addonAfter","prefix","bordered","readOnly","status","controls"]),l=n("input-number",b),[D,A]=qn(l),{compactSize:w,compactItemClassnames:_}=un(l,r);let F=s(Fn,{className:`${l}-handler-up-inner`}),T=s(zt,{className:`${l}-handler-down-inner`});const q=typeof $=="boolean"?$:void 0;typeof $=="object"&&(F=typeof $.upIcon>"u"?F:s("span",{className:`${l}-handler-up-inner`,children:$.upIcon}),T=typeof $.downIcon>"u"?T:s("span",{className:`${l}-handler-down-inner`,children:$.downIcon}));const{hasFeedback:O,status:k,isFormItemInput:z,feedbackIcon:X}=m.exports.useContext(Yt),J=cn(k,C),B=Zt(V=>{var S;return(S=w!=null?w:h)!==null&&S!==void 0?S:V}),j=x!=null||O,K=!!(i||g),H=m.exports.useContext(Jt),Y=u!=null?u:H,Q=G({[`${l}-lg`]:B==="large",[`${l}-sm`]:B==="small",[`${l}-rtl`]:r==="rtl",[`${l}-borderless`]:!N,[`${l}-in-form-item`]:z},Ee(l,J),_,A,c,!j&&!K&&p);let ee=s(ft,{...Object.assign({ref:d,disabled:Y,className:Q,upHandler:F,downHandler:T,prefixCls:l,readOnly:E,controls:q},R)});if(j){const V=G(`${l}-affix-wrapper`,Ee(`${l}-affix-wrapper`,J,O),{[`${l}-affix-wrapper-focused`]:a,[`${l}-affix-wrapper-disabled`]:t.disabled,[`${l}-affix-wrapper-sm`]:B==="small",[`${l}-affix-wrapper-lg`]:B==="large",[`${l}-affix-wrapper-rtl`]:r==="rtl",[`${l}-affix-wrapper-readonly`]:E,[`${l}-affix-wrapper-borderless`]:!N},!K&&c,!K&&p,A);ee=U("div",{className:V,style:t.style,onMouseUp:()=>d.current.focus(),children:[x&&s("span",{className:`${l}-prefix`,children:x}),Ye(ee,{style:null,value:t.value,onFocus:S=>{var P;o(!0),(P=t.onFocus)===null||P===void 0||P.call(t,S)},onBlur:S=>{var P;o(!1),(P=t.onBlur)===null||P===void 0||P.call(t,S)}}),O&&s("span",{className:`${l}-suffix`,children:X})]})}if(K){const V=`${l}-group`,S=`${V}-addon`,P=i?s("div",{className:S,children:i}):null,pe=g?s("div",{className:S,children:g}):null,ie=G(`${l}-wrapper`,V,A,{[`${V}-rtl`]:r==="rtl"}),oe=G(`${l}-group-wrapper`,{[`${l}-group-wrapper-sm`]:B==="small",[`${l}-group-wrapper-lg`]:B==="large",[`${l}-group-wrapper-rtl`]:r==="rtl"},Ee(`${l}-group-wrapper`,J,O),A,c,p);ee=s("div",{className:oe,style:t.style,children:U("div",{className:ie,children:[P&&s(Ze,{children:s(Xe,{status:!0,override:!0,children:P})}),Ye(ee,{style:null,disabled:Y}),pe&&s(Ze,{children:s(Xe,{status:!0,override:!0,children:pe})})]})})}return D(ee)}),mt=pt,Xn=t=>s(Qt,{theme:{components:{InputNumber:{handleVisible:!0}}},children:s(pt,{...Object.assign({},t)})});mt._InternalPanelDoNotUseOrYouWillBeFired=Xn;const Yn=mt;function Zn(){const t=m.exports.useRef(null),e=m.exports.useRef(),n=m.exports.useRef(),r=m.exports.useRef(),[a,o]=Ft({mnistDataPending:!1,trainPending:!1,trainEpoch:1,valAcc:0,valLoss:0,trainProgress:0,previewData:[]});Tt(()=>{b()});const d=async()=>{if(n.current&&r.current)return Z.warning("\u6570\u636E\u5DF2\u7ECF\u52A0\u8F7D\u4E86");o({mnistDataPending:!0});const i=await Promise.all([Sn(),yn()]);return n.current=i[0],r.current=i[1],o({mnistDataPending:!1}),Z.success("loading done!")},c=async()=>{if(!e.current)return Z.warning("\u6A21\u578B\u8FD8\u6CA1\u521B\u5EFA");if(!n.current||!r.current)return Z.warning("\u8BF7\u5148\u52A0\u8F7D\u6570\u636E");const i=a.trainEpoch;o({trainPending:!0}),console.log("Training model...");const g=320,x=.15,N=Je(n.current,[n.current.length/ae,be,Se,1]),E=Bt(r.current,[r.current.length/de,de]);let C=0;const $=Math.ceil(N.shape[0]*(1-x)/g)*i;e.current.fit(N,E,{batchSize:g,validationSplit:x,epochs:i,callbacks:{onBatchEnd:async(R,l)=>{C++;const D=~~(C/$*100*100)/100;o({trainProgress:D,valAcc:l.acc,valLoss:l.loss}),R%10===0&&h(),await We()},onEpochEnd:async(R,l)=>{console.log("Epoch: "+R+" Loss: "+l.loss),o({valAcc:l.val_acc,valLoss:l.val_loss}),h(),await We()},onTrainEnd:()=>{console.log("\u8BAD\u7EC3\u7ED3\u675F!"),o({trainPending:!1})}}})},p=()=>{if(e.current)return Z.success("\u6A21\u578B\u5DF2\u7ECF\u521B\u5EFA\uFF01");const i=Rt();i.add(Ce({inputShape:[be,Se,1],kernelSize:3,filters:16,activation:"relu"})),i.add(Ue({poolSize:2,strides:2})),i.add(Ce({kernelSize:3,filters:32,activation:"relu"})),i.add(Ue({poolSize:2,strides:2})),i.add(Ce({kernelSize:3,filters:32,activation:"relu"})),i.add(Mt({})),i.add(Ge({units:64,activation:"relu"})),i.add(Ge({units:10,activation:"softmax"})),i.compile({optimizer:"rmsprop",loss:"categoricalCrossentropy",metrics:["accuracy"]}),i.summary(),e.current=i,Z.success("\u6A21\u578B\u521B\u5EFA\u5B8C\u6210!")},h=()=>{if(!n.current||!r.current||!e.current)return;const i=[100,200],g=n.current.slice(ae*i[0],i[1]*ae),x=r.current.slice(de*i[0],i[1]*de),N=Je(g,[g.length/ae,be,Se,1]),E=x.reduce((l,D,A)=>D?[...l,A%10]:l,[]),C=e.current.predict(N),$=Array.from(C.argMax(1).dataSync());N.dispose(),C.dispose();const R=$.map((l,D)=>{const A=g.slice(D*784,D*784+784),w=E[D],_=document.createElement("canvas"),[F,T]=[28,28];_.width=F,_.height=T;const q=_.getContext("2d"),O=new ImageData(F,T);for(let k=0;k<T*F;k++){const z=k*4;O.data[z+0]=A[k],O.data[z+1]=A[k],O.data[z+2]=A[k],O.data[z+3]=255}return q.putImageData(O,0,0),{url:_.toDataURL("image/png"),real:w,predict:l}});o({previewData:R})},u=()=>{if(!e.current)return Z.warning("\u8BF7\u5148\u521B\u5EFA\u6A21\u578B");const i=Ot(t.current,1),x=_t.resizeBilinear(i,[28,28]).as4D(1,28,28,1),E=e.current.predict(x).argMax(1).dataSync();Z.success(E[0]),t.current.getContext("2d").fillRect(0,0,280,280)},b=()=>{const i=t.current;i.width=280,i.height=280;const g=i.getContext("2d");g.fillStyle="black",g.fillRect(0,0,280,280);let x=!1;i.addEventListener("mousedown",N=>{x=!0}),i.addEventListener("mouseup",N=>{x=!1}),i.addEventListener("mousemove",N=>{!x||(g.beginPath(),g.lineWidth=32,g.lineCap="round",g.strokeStyle="white",g.moveTo(N.offsetX,N.offsetY),g.lineTo(N.offsetX,N.offsetY),g.stroke())})};return U("div",{className:"container mx-auto p-4",children:[s("div",{className:"font-bold text-2xl mb-2",children:"\u8BAD\u7EC3\u53C2\u6570"}),U(qe,{className:"mb-2",children:[s(me,{loading:a.mnistDataPending,type:"primary",size:"large",onClick:d,children:"\u52A0\u8F7D\u6570\u636E"}),s(me,{onClick:p,type:"primary",size:"large",children:"\u521B\u5EFA\u6A21\u578B"}),s(me,{onClick:c,size:"large",danger:!0,loading:a.trainPending,children:"\u8BAD\u7EC3\u6A21\u578B"}),s("span",{children:"EPOCHS"}),s(Yn,{min:1,max:3,defaultValue:1,size:"large",onChange:i=>{typeof i=="number"&&o({trainEpoch:i})}})]}),s("div",{className:"font-bold text-2xl mb-2",children:"\u8BAD\u7EC3\u8FDB\u5EA6"}),U("div",{children:[a.valAcc?s(ut,{message:`\u7CBE\u5EA6\uFF1A${a.valAcc}\uFF0C\u8BEF\u5DEE\uFF1A${a.valLoss}`,type:"success"}):null,s(hn,{percent:a.trainProgress,steps:30,strokeColor:"#52c41a"})]}),s(qe,{className:"flex flex-wrap",children:a.previewData.map((i,g)=>U("div",{children:[s("div",{style:{backgroundColor:i.real===i.predict?"#34d66a":"red"},children:i.predict}),s("img",{src:i.url,alt:""})]},g))}),s("div",{className:"font-bold text-2xl mb-2",children:"\u6D4B\u8BD5\u6A21\u578B"}),s("div",{className:"mb-2",children:s(me,{size:"large",type:"primary",onClick:u,children:"\u9884\u6D4B"})}),s("div",{children:s("canvas",{ref:t})})]})}function Nr(){return s("div",{children:s(Zn,{})})}export{Nr as default};
